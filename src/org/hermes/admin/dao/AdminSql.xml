<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
        "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="org.hermes.admin.dao.AdminDao">
    <insert id="addWayBill" parameterType="org.hermes.admin.bean.WayBill" useGeneratedKeys="true" keyProperty="id">
            INSERT INTO hermes_waybill(
                    item_name,
                    origin_place,
                    destination,
                    weight,
                    expense,
                    state,
                    create_time,
                    sender,
                    receiver
            )
            VALUE (
                    #{itemName},
                    #{originPlace},
                    #{destination},
                    #{weight},
                    #{expense},
                    0,
                    now(),
                    #{sender},
                    #{receiver}
            )
    </insert>
    <select id="queryWayBill" resultType="org.hermes.admin.bean.WayBill">
        SELECT
                id,
                item_name as itemName,
                origin_place as originPlace,
                destination,
                weight,
                expense,
                state,
                DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s') as createTime,
                sender,
                receiver,
                DATE_FORMAT(received_time,'%Y-%m-%d %H:%i:%s') as receivedTime
        FROM hermes_waybill
    </select>
    <delete id="deleteWayBill" parameterType="String">
        DELETE FROM hermes_waybill WHERE id=#{id}
    </delete>


    <select id="queryDispatchInfo" resultType="org.hermes.admin.bean.DispatchInfo">
            SELECT
                  id,
                  vehicle_id as vehicleId,
                  driver_id as driverId,
                  origin_place as originPlace,
                  destination,
                  DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s') as createTime,
                  DATE_FORMAT(arrive_time,'%Y-%m-%d %H:%i:%s') as arriveTime,
                  state
            FROM hermes_dispatch
    </select>
    <insert id="addDispatchInfo" parameterType="org.hermes.admin.bean.DispatchInfo" useGeneratedKeys="true" keyProperty="id">
            INSERT INTO hermes_dispatch(
              vehicle_id,
              driver_id,
              origin_place,
              destination,
              create_time,
              state
            )
            VALUES (
              #{vehicleId},
              #{dirver_id},
              #{originPlace},
              #{destination},
              now(),
              0
            )
    </insert>
    <delete id="deleteDispatchInfo" parameterType="String">
        DELETE FROM hermes_dispatch WHERE id=#{id}
    </delete>
    <insert id="addDriver" parameterType="org.hermes.admin.bean.Driver" useGeneratedKeys="true" keyProperty="id">
      INSERT INTO hermes_driver(
        name,
        sex,
        driving_licence_type,
        driving_licence_number,
        driving_years,
        id_number,
        tel,
        address,
        remark
      )
      VALUES (
        #{name},
        #{sex},
        #{driverLicenceType},
        #{driverLicenceNumber},
        #{driverYears},
        #{idNumber},
        #{tel},
        #{address},
        #{remark}
      )
    </insert>
    <select id="queryDriver" resultType="org.hermes.admin.bean.Driver">
        SELECT
            id,
            name,
            sex,
            driving_licence_type as driverLicenceType,
            driving_licence_number as driverLicenceNumber,
            driving_years as driverYears,
            id_number idNumber,
            tel,
            address,
            remark
        FROM hermes_driver
    </select>
    <delete id="deleteDriver" parameterType="String">
        DELETE FROM hermes_driver WHERE id=#{id}
    </delete>
    <update id="updateDriver" parameterType="org.hermes.admin.bean.Driver">
        UPDATE hermes_driver SET
            name=#{name},
            sex=#{sex},
            driving_licence_type=#{driverLicenceType},
            driving_licence_number=#{driverLicenceNumber},
            driving_years=#{driverYears},
            id_number=#{idNumber},
            tel=#{tel},
            address=#{address},
            remark=#{remark}
        WHERE id=#{id}
    </update>

    <insert id="addVehicleInfo" parameterType="org.hermes.admin.bean.Vehicle" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO hermes_vehicle(
          plate_number,
          vehicle_type,
          owner_name,
          owner_tel,
          owner_id_number,
          owner_address,
          remark
        )
        VALUES (
            #{plateNumber},
            #{plateNumber},
            #{ownerName},
            #{ownerTel},
            #{ownerIdNumber},
            #{ownerAddress},
            #{remark}
        )
    </insert>
    <select id="queryVehicle" resultType="org.hermes.admin.bean.Vehicle">
        SELECT
            id,
            plate_number as plateNumber,
            vehicle_type as vehicleType,
            owner_name as ownerName,
            owner_tel as ownerTel,
            owner_id_number as ownerIdNumber,
            owner_address as ownerAddress,
            remark
        FROM hermes_vehicle
    </select>
    <delete id="deleteVehicleInfo" parameterType="int">
        DELETE FROM hermes_vehicle WHERE id=#{id}
    </delete>
    <update id="updateVehicleInfo" parameterType="org.hermes.admin.bean.Vehicle">
        UPDATE hermes_vehicle SET 
          plate_number= #{plateNumber},
          vehicle_type= #{vehicleType},
          owner_name= #{ownerName},
          owner_tel= #{ownerTel},
          owner_id_number=#{ownerIdNumber},
          owner_address=#{ownerAddress},
          remark=#{remark}
        WHERE id=#{id}
    </update>
</mapper>